
<div class="fr-container">    
  <div class="fr-grid-row fr-grid-row--gutters">
    <div class="fr-col-12 fr-col-lg-6 fr-col-offset-lg-3 fr-mb-5w">
       
      <h1 class="fr-my-5w tc">Connexion</h1>
    
      <%= form_for(resource, as: resource_name, url: session_path(resource_name),:html => {:id => "login"}, remote: true) do |f| %>

        <div class="fr-input-group ">
          <label class="fr-label" for="form-field1">Adresse mail*</label>
          <%= f.email_field :email,required: true, autofocus: true, autocomplete: "email",class:"fr-input", id: "form-field1" %>
        </div>

        <div class="fr-input-group ">
          <label class="fr-label" for="form-field2">Mot de passe*</label>
          <%= f.password_field :password,required: true, autocomplete: "current-password",class:"fr-input", id: "form-field2" %>
        </div>
        <div>
          <a class="fr-link fr-link--sm" href="mailto:budget.lab@finances.gouv.fr?subject=Mot de passe oublié -SIMP3" target="_blank" rel="noopener" title="Mot de passe oublié">Mot de passe oublié ? Contactez-nous </a>
       </div>

        <div id='error-message'></div>
        
     
        <div class="tc fr-mt-4w">
          <%= f.submit "Connexion", class:"fr-btn" %>
        </div>

      <% end %>
    </div>
  </div>
</div>

<script>
   $(document).ready(function() {
    //form id
    $('#login')
    .bind('ajax:success', function(evt, data, status, xhr) {
      //function called on status: 200 (for ex.)
      //console.log('success');
      window.location.href = "/"
    })
    .bind("ajax:error", function(evt, xhr, status, error) {
      //function called on status: 401 or 500 (for ex.)
      //console.log(xhr.responseText);
      $('#error-message').html("identifiant ou mot de passe non reconnu");
      $('#error-message').addClass('fr-error-text');
      $('#password').addClass('fr-input--error');
      $('#motdepasse').addClass('fr-input-group--error');
    });
  });

</script>
